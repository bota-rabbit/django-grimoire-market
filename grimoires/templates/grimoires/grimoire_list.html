{% extends 'grimoires/base.html' %}
{% block content %}

<div class="grimoire-list-page">

    <h1 class="page-title">å•†å“ä¸€è¦§</h1>

    {% if object_list %}
        <ul class="grimoire-list">
            {% for grimoire in object_list %}
                <li class="grimoire-item {% if grimoire.stock <= 0 %}is-sold-out{% endif %}">
                    
                    {% if grimoire.stock > 0 %}
                        <a href="{% url 'grimoires:grimoire_detail' grimoire.pk %}"
                        class="grimoire-card-link">
                    {% endif %}

                        {% load static %}

                        {% if grimoire.image %}
                            <img src="{{ grimoire.image.url }}"
                                alt="{{ grimoire.title }}"
                                class="grimoire-thumb">
                        {% else %}
                            <img src="{% static 'grimoires/images/no-image.png' %}"
                                alt="no image"
                                class="grimoire-thumb">
                        {% endif %}
                        
                        <div class="grimoire-info">
                            <strong class="grimoire-title">
                                {{ grimoire.title }}
                            </strong>

                            <span class="grimoire-price">
                                ä¾¡æ ¼: ğŸ’{{ grimoire.price }}
                            </span>

                            {% if grimoire.stock > 0 %}
                                <span class="in-stock">åœ¨åº«:{{ grimoire.stock }}</span>
                            {% else %}
                                <span class="sold-out">å£²ã‚Šåˆ‡ã‚Œ</span>
                            {% endif %}
                        </div>

                    {% if grimoire.stock > 0 %}
                        </a>
                    {% endif %}

                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="no-items-message">å•†å“ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endif %}

    <!-- ãƒšãƒ¼ã‚¸é€ã‚Š -->
    {% if is_paginated %}
        <div class="pagination">

            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}"
                   class="pagination-prev">
                    å‰ã¸
                </a>
            {% endif %}

            <span class="pagination-info">
                ãƒšãƒ¼ã‚¸ {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}"
                   class="pagination-next">
                    æ¬¡ã¸
                </a>
            {% endif %}

        </div>
    {% endif %}

</div>

{% endblock %}
