{% extends 'grimoires/base.html' %}
{% load static %}

{% block content %}

<div class="grimoire-list-page">

    <!-- „Éö„Éº„Ç∏„Çø„Ç§„Éà„É´ -->
    <h1 class="page-title">ÂïÜÂìÅ‰∏ÄË¶ß</h1>

    {% if object_list %}
        <ul class="grimoire-list">

            {% for grimoire in object_list %}
                <li class="grimoire-item 
                    {% if grimoire.stock <= 0 %}is-sold-out{% endif %}">
                    
                    {% if grimoire.stock > 0 %}
                        <a href="{% url 'grimoires:grimoire_detail' grimoire.pk %}"
                           class="grimoire-card">
                    {% else %}
                        <div class="grimoire-card is-disabled">
                    {% endif %}

                        <!-- „Çµ„É†„Éç„Ç§„É´ -->
                        {% if grimoire.image %}
                            <img src="{{ grimoire.image.url }}"
                                 alt="{{ grimoire.title }}"
                                 class="grimoire-thumb">
                        {% else %}
                            <img src="{% static 'grimoires/images/no-image.png' %}"
                                 alt="no image"
                                 class="grimoire-thumb">
                        {% endif %}
                        
                        <!-- ÊÉÖÂ†± -->
                        <div class="grimoire-info">

                            <strong class="grimoire-title">
                                {{ grimoire.title }}
                            </strong>

                            <span class="grimoire-price">
                                ‰æ°Ê†º: üíé{{ grimoire.price }}
                            </span>

                            {% if grimoire.stock > 0 %}
                                <span class="in-stock">
                                    Âú®Â∫´:{{ grimoire.stock }}
                                </span>
                            {% else %}
                                <span class="sold-out">
                                    Â£≤„ÇäÂàá„Çå
                                </span>
                            {% endif %}

                        </div>

                    {% if grimoire.stock > 0 %}
                        </a>
                    {% else %}
                        </div>
                    {% endif %}

                </li>
            {% endfor %}

        </ul>

    {% else %}
        <p class="no-items-message">
            ÂïÜÂìÅ„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ
        </p>
    {% endif %}

    <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ -->
    {% if is_paginated %}
        <div class="pagination">

            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}"
                   class="pagination-prev">
                    Ââç„Å∏
                </a>
            {% endif %}

            <span class="pagination-info">
                „Éö„Éº„Ç∏ {{ page_obj.number }}
                / 
                {{ page_obj.paginator.num_pages }}
            </span>

            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.next_page_number }}"
                   class="pagination-next">
                    Ê¨°„Å∏
                </a>
            {% endif %}

        </div>
    {% endif %}

</div>

{% endblock %}
